/** @license
 *
 * SoundManager 2: JavaScript Sound for the Web
 * ----------------------------------------------
 * http://schillmania.com/projects/soundmanager2/
 *
 * Copyright (c) 2007, Scott Schiller. All rights reserved.
 * Code provided under the BSD License:
 * http://schillmania.com/projects/soundmanager2/license.txt
 *
 * V2.97a.20130512
 */

// hat tip: Flash Detect library (BSD, (C) 2007) by Carl "DocYes" S. Yestrau - http://featureblend.com/javascript-flash-detection-library.html / http://featureblend.com/license.txt

(function(e,t){function r(n,r){function cn(e){return s.preferFlash&&Ht&&!s.ignoreFlash&&s.flash[e]!==t&&s.flash[e]}function hn(e){return function(t){var n=this._s,r;return!n||!n._a?(n&&n.id?s._wD(n.id+": Ignoring "+t.type):s._wD(l+"Ignoring "+t.type),r=null):r=e.call(this,t),r}}this.setupOptions={url:n||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1e3,wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!0,noSWFCache:!1,idPrefix:"sound"},this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100},this.flash9Options={isMovieStar:null,usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null},this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null},this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus","audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}},this.movieID="sm2-container",this.id=r||"sm2movie",this.debugID="soundmanager-debug",this.debugURLParam=/([#?&])debug=1/i,this.versionNumber="V2.97a.20130512",this.version=null,this.movieURL=null,this.altURL=null,this.swfLoaded=!1,this.enabled=!1,this.oMC=null,this.sounds={},this.soundIDs=[],this.muted=!1,this.didFlashBlock=!1,this.filePattern=null,this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i},this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1},this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null},this.html5={usingFlash:null},this.flash={},this.html5Only=!1,this.ignoreFlash=!1;var i,s=this,o=null,u=null,a="soundManager",f=a+": ",l="HTML5::",c,h=navigator.userAgent,p=e.location.href.toString(),d=document,v,m,g,y,b=[],w=!0,E,S=!1,x=!1,T=!1,N=!1,C=!1,k,L=0,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G=["log","info","warn","error"],Y=8,Z,et,tt,nt=null,rt=null,it,st,ot,ut,at,ft,lt,ct,ht,pt=!1,dt=!1,vt,mt,gt,yt=0,bt=null,wt,Et=[],St,xt=null,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t=Array.prototype.slice,Dt=!1,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut=0,zt=h.match(/(ipad|iphone|ipod)/i),Wt=h.match(/android/i),Xt=h.match(/msie/i),Vt=h.match(/webkit/i),$t=h.match(/safari/i)&&!h.match(/chrome/i),Jt=h.match(/opera/i),Kt=h.match(/firefox/i),Qt=h.match(/(mobile|pre\/|xoom)/i)||zt||Wt,Gt=!p.match(/usehtml5audio/i)&&!p.match(/sm2\-ignorebadua/i)&&$t&&!h.match(/silk/i)&&h.match(/OS X 10_6_([3-7])/i),Yt=e.console!==t&&console.log!==t,Zt=d.hasFocus!==t?d.hasFocus():null,en=$t&&(d.hasFocus===t||!d.hasFocus()),tn=!en,nn=/(mp3|mp4|mpa|m4a|m4b)/i,rn=1e3,sn="about:blank",on=d.location?d.location.protocol.match(/http/i):null,un=on?"":"http://",an=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,fn=["mpeg4","aac","flv","mov","mp4","m4v","f4v","m4a","m4b","mp4v","3gp","3g2"],ln=new RegExp("\\.("+fn.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i,this.useAltURL=!on,ut={swfBox:"sm2-object-box",swfDefault:"movieContainer",swfError:"swf_error",swfTimedout:"swf_timedout",swfLoaded:"swf_loaded",swfUnblocked:"swf_unblocked",sm2Debug:"sm2_debug",highPerf:"high_performance",flashDebug:"flash_debug"},this.hasHTML5=function(){try{return Audio!==t&&(Jt&&opera!==t&&opera.version()<10?new Audio(null):new Audio).canPlayType!==t}catch(e){return!1}}(),this.setup=function(e){var n=!s.url;return e!==t&&T&&xt&&s.ok()&&(e.flashVersion!==t||e.url!==t||e.html5Test!==t)&&ct(it("setupLate")),M(e),e&&(n&&X&&e.url!==t&&s.beginDelayedInit(),!X&&e.url!==t&&d.readyState==="complete"&&setTimeout(z,1)),s},this.ok=function(){return xt?T&&!N:s.useHTML5Audio&&s.hasHTML5},this.supported=this.ok,this.getMovie=function(t){return c(t)||d[t]||e[t]},this.createSound=function(e,n){function c(){return f=ft(f),s.sounds[f.id]=new i(f),s.soundIDs.push(f.id),s.sounds[f.id]}var r,o,f,l=null;r=a+".createSound(): ",o=r+it(T?"notOK":"notReady");if(!T||!s.ok())return ct(o),!1;n!==t&&(e={id:e,url:n}),f=O(e),f.url=wt(f.url),f.id===undefined&&(f.id=s.setupOptions.idPrefix+Ut++),f.id.toString().charAt(0).match(/^[0-9]$/)&&s._wD(r+it("badID",f.id),2),s._wD(r+f.id+(f.url?" ("+f.url+")":""),1);if(ht(f.id,!0))return s._wD(r+f.id+" exists",1),s.sounds[f.id];if(Nt(f))l=c(),s._wD(f.id+": Using HTML5"),l._setup_html5(f);else{if(s.html5Only)return s._wD(f.id+": No HTML5 support for this sound, and no Flash. Exiting."),c();if(s.html5.usingFlash&&f.url&&f.url.match(/data\:/i))return s._wD(f.id+": data: URIs not supported via Flash. Exiting."),c();y>8&&(f.isMovieStar===null&&(f.isMovieStar=!!(f.serverURL||(f.type?f.type.match(an):!1)||f.url&&f.url.match(ln))),f.isMovieStar&&(s._wD(r+"using MovieStar handling"),f.loops>1&&k("noNSLoop"))),f=lt(f,r),l=c(),y===8?u._createSound(f.id,f.loops||1,f.usePolicyFile):(u._createSound(f.id,f.url,f.usePeakData,f.useWaveformData,f.useEQData,f.isMovieStar,f.isMovieStar?f.bufferTime:!1,f.loops||1,f.serverURL,f.duration||null,f.autoPlay,!0,f.autoLoad,f.usePolicyFile),f.serverURL||(l.connected=!0,f.onconnect&&f.onconnect.apply(l))),!f.serverURL&&(f.autoLoad||f.autoPlay)&&l.load(f)}return!f.serverURL&&f.autoPlay&&l.play(),l},this.destroySound=function(e,t){if(!ht(e))return!1;var n=s.sounds[e],r;n._iO={},n.stop(),n.unload();for(r=0;r<s.soundIDs.length;r++)if(s.soundIDs[r]===e){s.soundIDs.splice(r,1);break}return t||n.destruct(!0),n=null,delete s.sounds[e],!0},this.load=function(e,t){return ht(e)?s.sounds[e].load(t):!1},this.unload=function(e){return ht(e)?s.sounds[e].unload():!1},this.onPosition=function(e,t,n,r){return ht(e)?s.sounds[e].onposition(t,n,r):!1},this.onposition=this.onPosition,this.clearOnPosition=function(e,t,n){return ht(e)?s.sounds[e].clearOnPosition(t,n):!1},this.play=function(e,t){var n=null,r=t&&!(t instanceof Object);if(!T||!s.ok())return ct(a+".play(): "+it(T?"notOK":"notReady")),!1;if(!ht(e,r)){if(!r)return!1;r&&(t={url:t}),t&&t.url&&(s._wD(a+'.play(): Attempting to create "'+e+'"',1),t.id=e,n=s.createSound(t).play())}else r&&(t={url:t});return n===null&&(n=s.sounds[e].play(t)),n},this.start=this.play,this.setPosition=function(e,t){return ht(e)?s.sounds[e].setPosition(t):!1},this.stop=function(e){return ht(e)?(s._wD(a+".stop("+e+")",1),s.sounds[e].stop()):!1},this.stopAll=function(){var e;s._wD(a+".stopAll()",1);for(e in s.sounds)s.sounds.hasOwnProperty(e)&&s.sounds[e].stop()},this.pause=function(e){return ht(e)?s.sounds[e].pause():!1},this.pauseAll=function(){var e;for(e=s.soundIDs.length-1;e>=0;e--)s.sounds[s.soundIDs[e]].pause()},this.resume=function(e){return ht(e)?s.sounds[e].resume():!1},this.resumeAll=function(){var e;for(e=s.soundIDs.length-1;e>=0;e--)s.sounds[s.soundIDs[e]].resume()},this.togglePause=function(e){return ht(e)?s.sounds[e].togglePause():!1},this.setPan=function(e,t){return ht(e)?s.sounds[e].setPan(t):!1},this.setVolume=function(e,t){return ht(e)?s.sounds[e].setVolume(t):!1},this.mute=function(e){var t=0;e instanceof String&&(e=null);if(!e){s._wD(a+".mute(): Muting all sounds");for(t=s.soundIDs.length-1;t>=0;t--)s.sounds[s.soundIDs[t]].mute();return s.muted=!0,!0}return ht(e)?(s._wD(a+'.mute(): Muting "'+e+'"'),s.sounds[e].mute()):!1},this.muteAll=function(){s.mute()},this.unmute=function(e){var t;e instanceof String&&(e=null);if(!e){s._wD(a+".unmute(): Unmuting all sounds");for(t=s.soundIDs.length-1;t>=0;t--)s.sounds[s.soundIDs[t]].unmute();return s.muted=!1,!0}return ht(e)?(s._wD(a+'.unmute(): Unmuting "'+e+'"'),s.sounds[e].unmute()):!1},this.unmuteAll=function(){s.unmute()},this.toggleMute=function(e){return ht(e)?s.sounds[e].toggleMute():!1},this.getMemoryUse=function(){var e=0;return u&&y!==8&&(e=parseInt(u._getMemoryUse(),10)),e},this.disable=function(n){var r;n===t&&(n=!1);if(N)return!1;N=!0,k("shutdown",1);for(r=s.soundIDs.length-1;r>=0;r--)Z(s.sounds[s.soundIDs[r]]);return A(n),Mt.remove(e,"load",H),!0},this.canPlayMIME=function(e){var t;return s.hasHTML5&&(t=Ct({type:e})),!t&&xt&&(t=e&&s.ok()?!!((y>8?e.match(an):null)||e.match(s.mimePattern)):null),t},this.canPlayURL=function(e){var t;return s.hasHTML5&&(t=Ct({url:e})),!t&&xt&&(t=e&&s.ok()?!!e.match(s.filePattern):null),t},this.canPlayLink=function(e){return e.type!==t&&e.type&&s.canPlayMIME(e.type)?!0:s.canPlayURL(e.href)},this.getSoundById=function(e,t){if(!e)return null;var n=s.sounds[e];return!n&&!t&&s._wD(a+'.getSoundById(): Sound "'+e+'" not found.',2),n},this.onready=function(t,n){var r="onready",i=!1;if(typeof t!="function")throw it("needFunction",r);return T&&s._wD(it("queue",r)),n||(n=e),D(r,t,n),P(),i=!0,i},this.ontimeout=function(t,n){var r="ontimeout",i=!1;if(typeof t!="function")throw it("needFunction",r);return T&&s._wD(it("queue",r)),n||(n=e),D(r,t,n),P({type:r}),i=!0,i},this._writeDebug=function(e,n){var r="soundmanager-debug",i,o;if(!s.debugMode)return!1;if(Yt&&s.useConsole){n&&typeof n=="object"?console.log(e,n):G[n]!==t?console[G[n]](e):console.log(e);if(s.consoleOnly)return!0}return i=c(r),i?(o=d.createElement("div"),++L%2===0&&(o.className="sm2-alt"),n===t?n=0:n=parseInt(n,10),o.appendChild(d.createTextNode(e)),n&&(n>=2&&(o.style.fontWeight="bold"),n===3&&(o.style.color="#ff3333")),i.insertBefore(o,i.firstChild),i=null,!0):!1},p.indexOf("sm2-debug=alert")!==-1&&(this._writeDebug=function(t){e.alert(t)}),this._wD=this._writeDebug,this._debug=function(){var e,t;k("currentObj",1);for(e=0,t=s.soundIDs.length;e<t;e++)s.sounds[s.soundIDs[e]]._debug()},this.reboot=function(t,n){s.soundIDs.length&&s._wD("Destroying "+s.soundIDs.length+" SMSound object"+(s.soundIDs.length!==1?"s":"")+"...");var r,i,o;for(r=s.soundIDs.length-1;r>=0;r--)s.sounds[s.soundIDs[r]].destruct();if(u)try{Xt&&(rt=u.innerHTML),nt=u.parentNode.removeChild(u)}catch(f){k("badRemove",2)}rt=nt=xt=u=null,s.enabled=X=T=pt=dt=S=x=N=Dt=s.swfLoaded=!1,s.soundIDs=[],s.sounds={},Ut=0;if(!t){for(r in b)if(b.hasOwnProperty(r))for(i=0,o=b[r].length;i<o;i++)b[r][i].fired=!1}else b=[];return n||s._wD(a+": Rebooting..."),s.html5={usingFlash:null},s.flash={},s.html5Only=!1,s.ignoreFlash=!1,e.setTimeout(function(){U(),n||s.beginDelayedInit()},20),s},this.reset=function(){return k("reset"),s.reboot(!0,!0)},this.getMoviePercent=function(){return u&&"PercentLoaded"in u?u.PercentLoaded():null},this.beginDelayedInit=function(){C=!0,z(),setTimeout(function(){return dt?!1:($(),R(),dt=!0,!0)},20),B()},this.destruct=function(){s._wD(a+".destruct()"),s.disable(!0)},i=function(e){var n=this,r,i,a,f,l,c,h=!1,p=[],d=0,v,m,g=null,b,w;b={duration:null,time:null},this.id=e.id,this.sID=this.id,this.url=e.url,this.options=O(e),this.instanceOptions=this.options,this._iO=this.instanceOptions,this.pan=this.options.pan,this.volume=this.options.volume,this.isHTML5=!1,this._a=null,w=this.url?!1:!0,this.id3={},this._debug=function(){s._wD(n.id+": Merged options:",n.options)},this.load=function(e){var r=null,i;e!==t?n._iO=O(e,n.options):(e=n.options,n._iO=e,g&&g!==n.url&&(k("manURL"),n._iO.url=n.url,n.url=null)),n._iO.url||(n._iO.url=n.url),n._iO.url=wt(n._iO.url),n.instanceOptions=n._iO,i=n._iO,s._wD(n.id+": load ("+i.url+")");if(!i.url&&!n.url)return s._wD(n.id+": load(): url is unassigned. Exiting.",2),n;!n.isHTML5&&y===8&&!n.url&&!i.autoPlay&&s._wD(n.id+": Flash 8 load() limitation: Wait for onload() before calling play().",1);if(i.url===n.url&&n.readyState!==0&&n.readyState!==2)return k("onURL",1),n.readyState===3&&i.onload&&Rt(n,function(){i.onload.apply(n,[!!n.duration])}),n;n.loaded=!1,n.readyState=1,n.playState=0,n.id3={};if(Nt(i))r=n._setup_html5(i),r._called_load?s._wD(n.id+": Ignoring request to load again"):(n._html5_canplay=!1,n.url!==i.url&&(s._wD(k("manURL")+": "+i.url),n._a.src=i.url,n.setPosition(0)),n._a.autobuffer="auto",n._a.preload="auto",n._a._called_load=!0,i.autoPlay&&n.play());else{if(s.html5Only)return s._wD(n.id+": No flash support. Exiting."),n;if(n._iO.url&&n._iO.url.match(/data\:/i))return s._wD(n.id+": data: URIs not supported via Flash. Exiting."),n;try{n.isHTML5=!1,n._iO=lt(ft(i)),i=n._iO,y===8?u._load(n.id,i.url,i.stream,i.autoPlay,i.usePolicyFile):u._load(n.id,i.url,!!i.stream,!!i.autoPlay,i.loops||1,!!i.autoLoad,i.usePolicyFile)}catch(o){k("smError",2),E("onload",!1),J({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}return n.url=i.url,n},this.unload=function(){return n.readyState!==0&&(s._wD(n.id+": unload()"),n.isHTML5?(f(),n._a&&(n._a.pause(),g=Lt(n._a))):y===8?u._unload(n.id,sn):u._unload(n.id),r()),n},this.destruct=function(e){s._wD(n.id+": Destruct"),n.isHTML5?(f(),n._a&&(n._a.pause(),Lt(n._a),Dt||a(),n._a._s=null,n._a=null)):(n._iO.onfailure=null,u._destroySound(n.id)),e||s.destroySound(n.id,!0)},this.play=function(e,r){var i,o,a,f,p,d,v,g=!0,b=null;i=n.id+": play(): ",r=r===t?!0:r,e||(e={}),n.url&&(n._iO.url=n.url),n._iO=O(n._iO,n.options),n._iO=O(e,n._iO),n._iO.url=wt(n._iO.url),n.instanceOptions=n._iO;if(!n.isHTML5&&n._iO.serverURL&&!n.connected)return n.getAutoPlay()||(s._wD(i+" Netstream not connected yet - setting autoPlay"),n.setAutoPlay(!0)),n;Nt(n._iO)&&(n._setup_html5(n._iO),l()),n.playState===1&&!n.paused&&(o=n._iO.multiShot,o?s._wD(i+"Already playing (multi-shot)",1):(s._wD(i+"Already playing (one-shot)",1),n.isHTML5&&n.setPosition(n._iO.position),b=n));if(b!==null)return b;e.url&&e.url!==n.url&&(!n.readyState&&!n.isHTML5&&y===8&&w?w=!1:n.load(n._iO)),n.loaded?s._wD(i.substr(0,i.lastIndexOf(":"))):n.readyState===0?(s._wD(i+"Attempting to load"),!n.isHTML5&&!s.html5Only?(n._iO.autoPlay=!0,n.load(n._iO)):n.isHTML5?n.load(n._iO):(s._wD(i+"Unsupported type. Exiting."),b=n),n.instanceOptions=n._iO):n.readyState===2?(s._wD(i+"Could not load - exiting",2),b=n):s._wD(i+"Loading - attempting to play...");if(b!==null)return b;!n.isHTML5&&y===9&&n.position>0&&n.position===n.duration&&(s._wD(i+"Sound at end, resetting to position:0"),e.position=0);if(n.paused&&n.position>=0&&(!n._iO.serverURL||n.position>0))s._wD(i+"Resuming from paused state",1),n.resume();else{n._iO=O(e,n._iO);if(n._iO.from!==null&&n._iO.to!==null&&n.instanceCount===0&&n.playState===0&&!n._iO.serverURL){f=function(){n._iO=O(e,n._iO),n.play(n._iO)},n.isHTML5&&!n._html5_canplay?(s._wD(i+"Beginning load for from/to case"),n.load({oncanplay:f}),b=!1):!n.isHTML5&&!n.loaded&&(!n.readyState||n.readyState!==2)&&(s._wD(i+"Preloading for from/to case"),n.load({onload:f}),b=!1);if(b!==null)return b;n._iO=m()}(!n.instanceCount||n._iO.multiShotEvents||n.isHTML5&&n._iO.multiShot&&!Dt||!n.isHTML5&&y>8&&!n.getAutoPlay())&&n.instanceCount++,n._iO.onposition&&n.playState===0&&c(n),n.playState=1,n.paused=!1,n.position=n._iO.position!==t&&!isNaN(n._iO.position)?n._iO.position:0,n.isHTML5||(n._iO=lt(ft(n._iO))),n._iO.onplay&&r&&(n._iO.onplay.apply(n),h=!0),n.setVolume(n._iO.volume,!0),n.setPan(n._iO.pan,!0),n.isHTML5?n.instanceCount<2?(l(),a=n._setup_html5(),n.setPosition(n._iO.position),a.play()):(s._wD(n.id+": Cloning Audio() for instance #"+n.instanceCount+"..."),p=new Audio(n._iO.url),d=function(){Mt.remove(p,"onended",d),n._onfinish(n),Lt(p),p=null},v=function(){Mt.remove(p,"canplay",v);try{p.currentTime=n._iO.position/rn}catch(e){ct(n.id+": multiShot play() failed to apply position of "+n._iO.position/rn)}p.play()},Mt.add(p,"ended",d),n._iO.position?Mt.add(p,"canplay",v):p.play()):(g=u._start(n.id,n._iO.loops||1,y===9?n.position:n.position/rn,n._iO.multiShot||!1),y===9&&!g&&(s._wD(i+"No sound hardware, or 32-sound ceiling hit",2),n._iO.onplayerror&&n._iO.onplayerror.apply(n)))}return n},this.start=this.play,this.stop=function(e){var t=n._iO,r;return n.playState===1&&(s._wD(n.id+": stop()"),n._onbufferchange(0),n._resetOnPosition(0),n.paused=!1,n.isHTML5||(n.playState=0),v(),t.to&&n.clearOnPosition(t.to),n.isHTML5?n._a&&(r=n.position,n.setPosition(0),n.position=r,n._a.pause(),n.playState=0,n._onTimer(),f()):(u._stop(n.id,e),t.serverURL&&n.unload()),n.instanceCount=0,n._iO={},t.onstop&&t.onstop.apply(n)),n},this.setAutoPlay=function(e){s._wD(n.id+": Autoplay turned "+(e?"on":"off")),n._iO.autoPlay=e,n.isHTML5||(u._setAutoPlay(n.id,e),e&&!n.instanceCount&&n.readyState===1&&(n.instanceCount++,s._wD(n.id+": Incremented instance count to "+n.instanceCount)))},this.getAutoPlay=function(){return n._iO.autoPlay},this.setPosition=function(e){e===t&&(e=0);var r,i,o=n.isHTML5?Math.max(e,0):Math.min(n.duration||n._iO.duration,Math.max(e,0));n.position=o,i=n.position/rn,n._resetOnPosition(n.position),n._iO.position=o;if(!n.isHTML5)r=y===9?n.position:i,n.readyState&&n.readyState!==2&&u._setPosition(n.id,r,n.paused||!n.playState,n._iO.multiShot);else if(n._a){if(n._html5_canplay){if(n._a.currentTime!==i){s._wD(n.id+": setPosition("+i+")");try{n._a.currentTime=i,(n.playState===0||n.paused)&&n._a.pause()}catch(a){s._wD(n.id+": setPosition("+i+") failed: "+a.message,2)}}}else if(i)return s._wD(n.id+": setPosition("+i+"): Cannot seek yet, sound not ready",2),n;n.paused&&n._onTimer(!0)}return n},this.pause=function(e){return n.paused||n.playState===0&&n.readyState!==1?n:(s._wD(n.id+": pause()"),n.paused=!0,n.isHTML5?(n._setup_html5().pause(),f()):(e||e===t)&&u._pause(n.id,n._iO.multiShot),n._iO.onpause&&n._iO.onpause.apply(n),n)},this.resume=function(){var e=n._iO;return n.paused?(s._wD(n.id+": resume()"),n.paused=!1,n.playState=1,n.isHTML5?(n._setup_html5().play(),l()):(e.isMovieStar&&!e.serverURL&&n.setPosition(n.position),u._pause(n.id,e.multiShot)),!h&&e.onplay?(e.onplay.apply(n),h=!0):e.onresume&&e.onresume.apply(n),n):n},this.togglePause=function(){return s._wD(n.id+": togglePause()"),n.playState===0?(n.play({position:y===9&&!n.isHTML5?n.position:n.position/rn}),n):(n.paused?n.resume():n.pause(),n)},this.setPan=function(e,r){return e===t&&(e=0),r===t&&(r=!1),n.isHTML5||u._setPan(n.id,e),n._iO.pan=e,r||(n.pan=e,n.options.pan=e),n},this.setVolume=function(e,r){return e===t&&(e=100),r===t&&(r=!1),n.isHTML5?n._a&&(n._a.volume=Math.max(0,Math.min(1,e/100))):u._setVolume(n.id,s.muted&&!n.muted||n.muted?0:e),n._iO.volume=e,r||(n.volume=e,n.options.volume=e),n},this.mute=function(){return n.muted=!0,n.isHTML5?n._a&&(n._a.muted=!0):u._setVolume(n.id,0),n},this.unmute=function(){n.muted=!1;var e=n._iO.volume!==t;return n.isHTML5?n._a&&(n._a.muted=!1):u._setVolume(n.id,e?n._iO.volume:n.options.volume),n},this.toggleMute=function(){return n.muted?n.unmute():n.mute()},this.onPosition=function(e,r,i){return p.push({position:parseInt(e,10),method:r,scope:i!==t?i:n,fired:!1}),n},this.onposition=this.onPosition,this.clearOnPosition=function(e,t){var n;e=parseInt(e,10);if(isNaN(e))return!1;for(n=0;n<p.length;n++)e===p[n].position&&(!t||t===p[n].method)&&(p[n].fired&&d--,p.splice(n,1))},this._processOnPosition=function(){var e,t,r=p.length;if(!r||!n.playState||d>=r)return!1;for(e=r-1;e>=0;e--)t=p[e],!t.fired&&n.position>=t.position&&(t.fired=!0,d++,t.method.apply(t.scope,[t.position]));return!0},this._resetOnPosition=function(e){var t,n,r=p.length;if(!r)return!1;for(t=r-1;t>=0;t--)n=p[t],n.fired&&e<=n.position&&(n.fired=!1,d--);return!0},m=function(){var e=n._iO,t=e.from,r=e.to,i,o;return o=function(){s._wD(n.id+': "To" time of '+r+" reached."),n.clearOnPosition(r,o),n.stop()},i=function(){s._wD(n.id+': Playing "from" '+t),r!==null&&!isNaN(r)&&n.onPosition(r,o)},t!==null&&!isNaN(t)&&(e.position=t,e.multiShot=!1,i()),e},c=function(){var e,t=n._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&n.onPosition(parseInt(e,10),t[e])},v=function(){var e,t=n._iO.onposition;if(t)for(e in t)t.hasOwnProperty(e)&&n.clearOnPosition(parseInt(e,10))},l=function(){n.isHTML5&&vt(n)},f=function(){n.isHTML5&&mt(n)},r=function(e){e||(p=[],d=0),h=!1,n._hasTimer=null,n._a=null,n._html5_canplay=!1,n.bytesLoaded=null,n.bytesTotal=null,n.duration=n._iO&&n._iO.duration?n._iO.duration:null,n.durationEstimate=null,n.buffered=[],n.eqData=[],n.eqData.left=[],n.eqData.right=[],n.failures=0,n.isBuffering=!1,n.instanceOptions={},n.instanceCount=0,n.loaded=!1,n.metadata={},n.readyState=0,n.muted=!1,n.paused=!1,n.peakData={left:0,right:0},n.waveformData={left:[],right:[]},n.playState=0,n.position=null,n.id3={}},r(),this._onTimer=function(e){var t,r=!1,i,s={};if(n._hasTimer||e)return n._a&&(e||(n.playState>0||n.readyState===1)&&!n.paused)&&(t=n._get_html5_duration(),t!==b.duration&&(b.duration=t,n.duration=t,r=!0),n.durationEstimate=n.duration,i=n._a.currentTime*rn||0,i!==b.time&&(b.time=i,r=!0),(r||e)&&n._whileplaying(i,s,s,s,s)),r},this._get_html5_duration=function(){var e=n._iO,t=n._a&&n._a.duration?n._a.duration*rn:e&&e.duration?e.duration:null,r=t&&!isNaN(t)&&t!==Infinity?t:null;return r},this._apply_loop=function(e,t){!e.loop&&t>1&&s._wD("Note: Native HTML5 looping is infinite.",1),e.loop=t>1?"loop":""},this._setup_html5=function(e){var t=O(n._iO,e),s=Dt?o:n._a,u=decodeURI(t.url),a;Dt?u===decodeURI(Pt)&&(a=!0):u===decodeURI(g)&&(a=!0);if(s){if(s._s)if(Dt)s._s&&s._s.playState&&!a&&s._s.stop();else if(!Dt&&u===decodeURI(g))return n._apply_loop(s,t.loops),s;a||(r(!1),s.src=t.url,n.url=t.url,g=t.url,Pt=t.url,s._called_load=!1)}else t.autoLoad||t.autoPlay?n._a=new Audio(t.url):n._a=Jt&&opera.version()<10?new Audio(null):new Audio,s=n._a,s._called_load=!1,Dt&&(o=s);return n.isHTML5=!0,n._a=s,s._s=n,i(),n._apply_loop(s,t.loops),t.autoLoad||t.autoPlay?n.load():(s.autobuffer=!1,s.preload="auto"),s},i=function(){function t(e,t,r){return n._a?n._a.addEventListener(e,t,r||!1):null}if(n._a._added_events)return!1;var e;n._a._added_events=!0;for(e in Ft)Ft.hasOwnProperty(e)&&t(e,Ft[e]);return!0},a=function(){function t(e,t,r){return n._a?n._a.removeEventListener(e,t,r||!1):null}var e;s._wD(n.id+": Removing event listeners"),n._a._added_events=!1;for(e in Ft)Ft.hasOwnProperty(e)&&t(e,Ft[e])},this._onload=function(e){var t,r=!!e||!n.isHTML5&&y===8&&n.duration;return t=n.id+": ",s._wD(t+(r?"onload()":"Failed to load / invalid sound?"+(n.duration?" -":" Zero-length duration reported.")+" ("+n.url+")"),r?1:2),!r&&!n.isHTML5&&(s.sandbox.noRemote===!0&&s._wD(t+it("noNet"),1),s.sandbox.noLocal===!0&&s._wD(t+it("noLocal"),1)),n.loaded=r,n.readyState=r?3:2,n._onbufferchange(0),n._iO.onload&&Rt(n,function(){n._iO.onload.apply(n,[r])}),!0},this._onbufferchange=function(e){return n.playState===0?!1:e&&n.isBuffering||!e&&!n.isBuffering?!1:(n.isBuffering=e===1,n._iO.onbufferchange&&(s._wD(n.id+": Buffer state change: "+e),n._iO.onbufferchange.apply(n)),!0)},this._onsuspend=function(){return n._iO.onsuspend&&(s._wD(n.id+": Playback suspended"),n._iO.onsuspend.apply(n)),!0},this._onfailure=function(e,t,r){n.failures++,s._wD(n.id+": Failures = "+n.failures),n._iO.onfailure&&n.failures===1?n._iO.onfailure(n,e,t,r):s._wD(n.id+": Ignoring failure")},this._onfinish=function(){var e=n._iO.onfinish;n._onbufferchange(0),n._resetOnPosition(0),n.instanceCount&&(n.instanceCount--,n.instanceCount||(v(),n.playState=0,n.paused=!1,n.instanceCount=0,n.instanceOptions={},n._iO={},f(),n.isHTML5&&(n.position=0)),(!n.instanceCount||n._iO.multiShotEvents)&&e&&(s._wD(n.id+": onfinish()"),Rt(n,function(){e.apply(n)})))},this._whileloading=function(e,t,r,i){var s=n._iO;n.bytesLoaded=e,n.bytesTotal=t,n.duration=Math.floor(r),n.bufferLength=i,!n.isHTML5&&!s.isMovieStar?s.duration?n.durationEstimate=n.duration>s.duration?n.duration:s.duration:n.durationEstimate=parseInt(n.bytesTotal/n.bytesLoaded*n.duration,10):n.durationEstimate=n.duration,n.isHTML5||(n.buffered=[{start:0,end:n.duration}]),(n.readyState!==3||n.isHTML5)&&s.whileloading&&s.whileloading.apply(n)},this._whileplaying=function(e,r,i,s,o){var u=n._iO,a;return isNaN(e)||e===null?!1:(n.position=Math.max(0,e),n._processOnPosition(),!n.isHTML5&&y>8&&(u.usePeakData&&r!==t&&r&&(n.peakData={left:r.leftPeak,right:r.rightPeak}),u.useWaveformData&&i!==t&&i&&(n.waveformData={left:i.split(","),right:s.split(",")}),u.useEQData&&o!==t&&o&&o.leftEQ&&(a=o.leftEQ.split(","),n.eqData=a,n.eqData.left=a,o.rightEQ!==t&&o.rightEQ&&(n.eqData.right=o.rightEQ.split(",")))),n.playState===1&&(!n.isHTML5&&y===8&&!n.position&&n.isBuffering&&n._onbufferchange(0),u.whileplaying&&u.whileplaying.apply(n)),!0)},this._oncaptiondata=function(e){s._wD(n.id+": Caption data received."),n.captiondata=e,n._iO.oncaptiondata&&n._iO.oncaptiondata.apply(n,[e])},this._onmetadata=function(e,t){s._wD(n.id+": Metadata received.");var r={},i,o;for(i=0,o=e.length;i<o;i++)r[e[i]]=t[i];n.metadata=r,n._iO.onmetadata&&n._iO.onmetadata.apply(n)},this._onid3=function(e,t){s._wD(n.id+": ID3 data received.");var r=[],i,o;for(i=0,o=e.length;i<o;i++)r[e[i]]=t[i];n.id3=O(n.id3,r),n._iO.onid3&&n._iO.onid3.apply(n)},this._onconnect=function(e){e=e===1,s._wD(n.id+": "+(e?"Connected.":"Failed to connect? - "+n.url),e?1:2),n.connected=e,e&&(n.failures=0,ht(n.id)&&(n.getAutoPlay()?n.play(t,n.getAutoPlay()):n._iO.autoLoad&&n.load()),n._iO.onconnect&&n._iO.onconnect.apply(n,[e]))},this._ondataerror=function(e){n.playState>0&&(s._wD(n.id+": Data error: "+e),n._iO.ondataerror&&n._iO.ondataerror.apply(n))},this._debug()},V=function(){return d.body||d._docElement||d.getElementsByTagName("div")[0]},c=function(e){return d.getElementById(e)},O=function(e,n){var r=e||{},i,o;i=n===t?s.defaultOptions:n;for(o in i)i.hasOwnProperty(o)&&r[o]===t&&(typeof i[o]!="object"||i[o]===null?r[o]=i[o]:r[o]=O(r[o],i[o]));return r},Rt=function(t,n){!t.isHTML5&&y===8?e.setTimeout(n,0):n()},_={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1},M=function(e,n){var r,i=!0,o=n!==t,u=s.setupOptions,a=_;if(e===t){i=[];for(r in u)u.hasOwnProperty(r)&&i.push(r);for(r in a)a.hasOwnProperty(r)&&(typeof s[r]=="object"?i.push(r+": {...}"):s[r]instanceof Function?i.push(r+": function() {...}"):i.push(r));return s._wD(it("setup",i.join(", "))),!1}for(r in e)if(e.hasOwnProperty(r))if(typeof e[r]!="object"||e[r]===null||e[r]instanceof Array||e[r]instanceof RegExp)o&&a[n]!==t?s[n][r]=e[r]:u[r]!==t?(s.setupOptions[r]=e[r],s[r]=e[r]):a[r]===t?(ct(it(s[r]===t?"setupUndef":"setupError",r),2),i=!1):s[r]instanceof Function?s[r].apply(s,e[r]instanceof Array?e[r]:[e[r]]):s[r]=e[r];else{if(a[r]!==t)return M(e[r],r);ct(it(s[r]===t?"setupUndef":"setupError",r),2),i=!1}return i},Mt=function(){function r(e){var n=_t.call(e),r=n.length;return t?(n[1]="on"+n[1],r>3&&n.pop()):r===3&&n.push(!1),n}function i(e,r){var i=e.shift(),s=[n[r]];t?i[s](e[0],e[1]):i[s].apply(i,e)}function s(){i(r(arguments),"add")}function o(){i(r(arguments),"remove")}var t=e.attachEvent,n={add:t?"attachEvent":"addEventListener",remove:t?"detachEvent":"removeEventListener"};return{add:s,remove:o}}(),Ft={abort:hn(function(){s._wD(this._s.id+": abort")}),canplay:hn(function(){var e=this._s,n;if(e._html5_canplay)return!0;e._html5_canplay=!0,s._wD(e.id+": canplay"),e._onbufferchange(0),n=e._iO.position!==t&&!isNaN(e._iO.position)?e._iO.position/rn:null;if(e.position&&this.currentTime!==n){s._wD(e.id+": canplay: Setting position to "+n);try{this.currentTime=n}catch(r){s._wD(e.id+": canplay: Setting position of "+n+" failed: "+r.message,2)}}e._iO._oncanplay&&e._iO._oncanplay()}),canplaythrough:hn(function(){var e=this._s;e.loaded||(e._onbufferchange(0),e._whileloading(e.bytesLoaded,e.bytesTotal,e._get_html5_duration()),e._onload(!0))}),ended:hn(function(){var e=this._s;s._wD(e.id+": ended"),e._onfinish()}),error:hn(function(){s._wD(this._s.id+": HTML5 error, code "+this.error.code),this._s._onload(!1)}),loadeddata:hn(function(){var e=this._s;s._wD(e.id+": loadeddata"),!e._loaded&&!$t&&(e.duration=e._get_html5_duration())}),loadedmetadata:hn(function(){s._wD(this._s.id+": loadedmetadata")}),loadstart:hn(function(){s._wD(this._s.id+": loadstart"),this._s._onbufferchange(1)}),play:hn(function(){this._s._onbufferchange(0)}),playing:hn(function(){s._wD(this._s.id+": playing"),this._s._onbufferchange(0)}),progress:hn(function(e){var t=this._s,n,r,i,o=0,u=e.type==="progress",a=e.target.buffered,f=e.loaded||0,l=e.total||1;t.buffered=[];if(a&&a.length){for(n=0,r=a.length;n<r;n++)t.buffered.push({start:a.start(n)*rn,end:a.end(n)*rn});o=(a.end(0)-a.start(0))*rn,f=Math.min(1,o/(e.target.duration*rn));if(u&&a.length>1){i=[],r=a.length;for(n=0;n<r;n++)i.push(e.target.buffered.start(n)*rn+"-"+e.target.buffered.end(n)*rn);s._wD(this._s.id+": progress, timeRanges: "+i.join(", "))}u&&!isNaN(f)&&s._wD(this._s.id+": progress, "+Math.floor(f*100)+"% loaded")}isNaN(f)||(t._onbufferchange(0),t._whileloading(f,l,t._get_html5_duration()),f&&l&&f===l&&Ft.canplaythrough.call(this,e))}),ratechange:hn(function(){s._wD(this._s.id+": ratechange")}),suspend:hn(function(e){var t=this._s;s._wD(this._s.id+": suspend"),Ft.progress.call(this,e),t._onsuspend()}),stalled:hn(function(){s._wD(this._s.id+": stalled")}),timeupdate:hn(function(){this._s._onTimer()}),waiting:hn(function(){var e=this._s;s._wD(this._s.id+": waiting"),e._onbufferchange(1)})},Nt=function(e){var t;return!e||!e.type&&!e.url&&!e.serverURL?t=!1:e.serverURL||e.type&&cn(e.type)?t=!1:t=e.type?Ct({type:e.type}):Ct({url:e.url})||s.html5Only||e.url.match(/data\:/i),t},Lt=function(e){var t;return e&&(t=$t&&!zt?null:Kt?sn:null,e.src=t||"",e._called_unload!==undefined&&(e._called_load=!1)),Dt&&(Pt=null),t},Ct=function(e){if(!s.useHTML5Audio||!s.hasHTML5)return!1;var n=e.url||null,r=e.type||null,i=s.audioFormats,o,u,a,f;if(r&&s.html5[r]!==t)return s.html5[r]&&!cn(r);if(!kt){kt=[];for(f in i)i.hasOwnProperty(f)&&(kt.push(f),i[f].related&&(kt=kt.concat(i[f].related)));kt=new RegExp("\\.("+kt.join("|")+")(\\?.*)?$","i")}return a=n?n.toLowerCase().match(kt):null,!a||!a.length?r?(u=r.indexOf(";"),a=(u!==-1?r.substr(0,u):r).substr(6)):o=!1:a=a[1],a&&s.html5[a]!==t?o=s.html5[a]&&!cn(a):(r="audio/"+a,o=s.html5.canPlayType({type:r}),s.html5[a]=o,o=o&&s.html5[r]&&!cn(r)),o},Ot=function(){function a(t){var n,r,i,o=!1,u=!1;if(!e||typeof e.canPlayType!="function")return o;if(t instanceof Array){for(r=0,i=t.length;r<i;r++)if(s.html5[t[r]]||e.canPlayType(t[r]).match(s.html5Test))u=!0,s.html5[t[r]]=!0,s.flash[t[r]]=!!t[r].match(nn);o=u}else n=e&&typeof e.canPlayType=="function"?e.canPlayType(t):!1,o=!!n&&!!n.match(s.html5Test);return o}if(!s.useHTML5Audio||!s.hasHTML5)return s.html5.usingFlash=!0,xt=!0,!1;var e=Audio!==t?Jt&&opera.version()<10?new Audio(null):new Audio:null,n,r,i={},o,u;o=s.audioFormats;for(n in o)if(o.hasOwnProperty(n)){r="audio/"+n,i[n]=a(o[n].type),i[r]=i[n],n.match(nn)?(s.flash[n]=!0,s.flash[r]=!0):(s.flash[n]=!1,s.flash[r]=!1);if(o[n]&&o[n].related)for(u=o[n].related.length-1;u>=0;u--)i["audio/"+o[n].related[u]]=i[n],s.html5[o[n].related[u]]=i[n],s.flash[o[n].related[u]]=i[n]}return i.canPlayType=e?a:null,s.html5=O(s.html5,i),s.html5.usingFlash=Tt(),xt=s.html5.usingFlash,!0},q={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:a+"exception caught while appending SWF to DOM.",spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:f+"Verify that %s is a valid path.",tryDebug:"Try "+a+".debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:f+"Non-HTTP page ("+d.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",waitFocus:f+"Special case: Waiting for SWF to load with window focus...",waitForever:f+"Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:f+"Waiting for 100% SWF load...",needFunction:f+"Function object expected for %s",badID:'Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:f+"_debug(): Current sound objects",waitOnload:f+"Waiting for window.onload()",docLoaded:f+"Document already loaded",onload:f+"initComplete(): calling soundManager.onload()",onloadOK:a+".onload() complete",didInit:f+"init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:f+"Failed to remove Flash node.",shutdown:a+".disable(): Shutting down",queue:f+"Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying ."+ut.swfTimedout+" CSS...",fbLoaded:"Flash loaded",fbHandler:f+"flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:a+".load(): current URL already assigned.",badFV:a+'.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:f+"Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:f+"Got window focus.",policy:"Enabling usePolicyFile for data access",setup:a+".setup(): allowed parameters: %s",setupError:a+'.setup(): "%s" cannot be assigned with this method.',setupUndef:a+'.setup(): Could not find option "%s"',setupLate:a+".setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:f+"Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready.",reset:a+".reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device."},it=function(){var e=_t.call(arguments),t=e.shift(),n=q&&q[t]?q[t]:"",r,i;if(n&&e&&e.length)for(r=0,i=e.length;r<i;r++)n=n.replace("%s",e[r]);return n},ft=function(e){return y===8&&e.loops>1&&e.stream&&(k("as2loop"),e.stream=!1),e},lt=function(e,t){return e&&!e.usePolicyFile&&(e.onid3||e.usePeakData||e.useWaveformData||e.useEQData)&&(s._wD((t||"")+it("policy")),e.usePolicyFile=!0),e},ct=function(e){Yt&&console.warn!==t?console.warn(e):s._wD(e)},v=function(){return!1},Z=function(e){var t;for(t in e)e.hasOwnProperty(t)&&typeof e[t]=="function"&&(e[t]=v);t=null},et=function(e){e===t&&(e=!1),(N||e)&&s.disable(e)},tt=function(e){var t=null,n;if(e)if(e.match(/\.swf(\?.*)?$/i)){t=e.substr(e.toLowerCase().lastIndexOf(".swf?")+4);if(t)return e}else e.lastIndexOf("/")!==e.length-1&&(e+="/");return n=(e&&e.lastIndexOf("/")!==-1?e.substr(0,e.lastIndexOf("/")+1):"./")+s.movieURL,s.noSWFCache&&(n+="?ts="+(new Date).getTime()),n},F=function(){y=parseInt(s.flashVersion,10),y!==8&&y!==9&&(s._wD(it("badFV",y,Y)),s.flashVersion=y=Y);var e=s.debugMode||s.debugFlash?"_debug.swf":".swf";s.useHTML5Audio&&!s.html5Only&&s.audioFormats.mp4.required&&y<9&&(s._wD(it("needfl9")),s.flashVersion=y=9),s.version=s.versionNumber+(s.html5Only?" (HTML5-only mode)":y===9?" (AS3/Flash 9)":" (AS2/Flash 8)"),y>8?(s.defaultOptions=O(s.defaultOptions,s.flash9Options),s.features.buffering=!0,s.defaultOptions=O(s.defaultOptions,s.movieStarOptions),s.filePatterns.flash9=new RegExp("\\.(mp3|"+fn.join("|")+")(\\?.*)?$","i"),s.features.movieStar=!0):s.features.movieStar=!1,s.filePattern=s.filePatterns[y!==8?"flash9":"flash8"],s.movieURL=(y===8?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",e),s.features.peakData=s.features.waveformData=s.features.eqData=y>8},K=function(e,t){if(!u)return!1;u._setPolling(e,t)},Q=function(){s.debugURLParam.test(p)&&(s.debugMode=!0);if(c(s.debugID))return!1;var e,t,n,r,i;if(s.debugMode&&!c(s.debugID)&&(!Yt||!s.useConsole||!s.consoleOnly)){e=d.createElement("div"),e.id=s.debugID+"-toggle",r={position:"fixed",bottom:"0px",right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001},e.appendChild(d.createTextNode("-")),e.onclick=at,e.title="Toggle SM2 debug console",h.match(/msie 6/i)&&(e.style.position="absolute",e.style.cursor="hand");for(i in r)r.hasOwnProperty(i)&&(e.style[i]=r[i]);t=d.createElement("div"),t.id=s.debugID,t.style.display=s.debugMode?"block":"none";if(s.debugMode&&!c(e.id)){try{n=V(),n.appendChild(e)}catch(o){throw new Error(it("domError")+" \n"+o.toString())}n.appendChild(t)}}n=null},ht=this.getSoundById,k=function(e,t){return e?s._wD(it(e),t):""},at=function(){var e=c(s.debugID),t=c(s.debugID+"-toggle");if(!e)return!1;w?(t.innerHTML="+",e.style.display="none"):(t.innerHTML="-",e.style.display="block"),w=!w},E=function(n,r,i){if(e.sm2Debugger!==t)try{sm2Debugger.handleEvent(n,r,i)}catch(s){return!1}return!0},ot=function(){var e=[];return s.debugMode&&e.push(ut.sm2Debug),s.debugFlash&&e.push(ut.flashDebug),s.useHighPerformance&&e.push(ut.highPerf),e.join(" ")},st=function(){var e=it("fbHandler"),t=s.getMoviePercent(),n=ut,r={type:"FLASHBLOCK"};if(s.html5Only)return!1;s.ok()?(s.didFlashBlock&&s._wD(e+": Unblocked"),s.oMC&&(s.oMC.className=[ot(),n.swfDefault,n.swfLoaded+(s.didFlashBlock?" "+n.swfUnblocked:"")].join(" "))):(xt&&(s.oMC.className=ot()+" "+n.swfDefault+" "+(t===null?n.swfTimedout:n.swfError),s._wD(e+": "+it("fbTimeout")+(t?" ("+it("fbLoaded")+")":""))),s.didFlashBlock=!0,P({type:"ontimeout",ignoreInit:!0,error:r}),J(r))},D=function(e,n,r){b[e]===t&&(b[e]=[]),b[e].push({method:n,scope:r||null,fired:!1})},P=function(e){e||(e={type:s.ok()?"onready":"ontimeout"});if(!T&&e&&!e.ignoreInit)return!1;if(e.type==="ontimeout"&&(s.ok()||N&&!e.ignoreInit))return!1;var t={success:e&&e.ignoreInit?s.ok():!N},n=e&&e.type?b[e.type]||[]:[],r=[],i,o,u=[t],a=xt&&!s.ok();e.error&&(u[0].error=e.error);for(i=0,o=n.length;i<o;i++)n[i].fired!==!0&&r.push(n[i]);if(r.length)for(i=0,o=r.length;i<o;i++)r[i].scope?r[i].method.apply(r[i].scope,u):r[i].method.apply(this,u),a||(r[i].fired=!0);return!0},H=function(){e.setTimeout(function(){s.useFlashBlock&&st(),P(),typeof s.onload=="function"&&(k("onload",1),s.onload.apply(e),k("onloadOK",1)),s.waitForWindowLoad&&Mt.add(e,"load",H)},1)},Bt=function(){if(Ht!==t)return Ht;var n=!1,r=navigator,i=r.plugins,s,o,u,a=e.ActiveXObject;if(i&&i.length)o="application/x-shockwave-flash",u=r.mimeTypes,u&&u[o]&&u[o].enabledPlugin&&u[o].enabledPlugin.description&&(n=!0);else if(a!==t&&!h.match(/MSAppHost/i)){try{s=new a("ShockwaveFlash.ShockwaveFlash")}catch(f){s=null}n=!!s,s=null}return Ht=n,n},Tt=function(){var e,t,n=s.audioFormats,r=zt&&!!h.match(/os (1|2|3_0|3_1)/i);if(r)s.hasHTML5=!1,s.html5Only=!0,s.oMC&&(s.oMC.style.display="none");else if(s.useHTML5Audio){if(!s.html5||!s.html5.canPlayType)s._wD("SoundManager: No HTML5 Audio() support detected."),s.hasHTML5=!1;Gt&&s._wD(f+"Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+(Ht?"will use flash fallback for MP3/MP4, if available":" would use flash fallback for MP3/MP4, but none detected."),1)}if(s.useHTML5Audio&&s.hasHTML5){St=!0;for(t in n)n.hasOwnProperty(t)&&n[t].required&&(s.html5.canPlayType(n[t].type)?s.preferFlash&&(s.flash[t]||s.flash[n[t].type])&&(e=!0):(St=!1,e=!0))}return s.ignoreFlash&&(e=!1,St=!0),s.html5Only=s.hasHTML5&&s.useHTML5Audio&&!e,!s.html5Only},wt=function(e){var t,n,r=0,i;if(e instanceof Array){for(t=0,n=e.length;t<n;t++)if(e[t]instanceof Object){if(s.canPlayMIME(e[t].type)){r=t;break}}else if(s.canPlayURL(e[t])){r=t;break}e[r].url&&(e[r]=e[r].url),i=e[r]}else i=e;return i},vt=function(e){e._hasTimer||(e._hasTimer=!0,!Qt&&s.html5PollingInterval&&(bt===null&&yt===0&&(bt=setInterval(gt,s.html5PollingInterval)),yt++))},mt=function(e){e._hasTimer&&(e._hasTimer=!1,!Qt&&s.html5PollingInterval&&yt--)},gt=function(){var e;if(bt!==null&&!yt)return clearInterval(bt),bt=null,!1;for(e=s.soundIDs.length-1;e>=0;e--)s.sounds[s.soundIDs[e]].isHTML5&&s.sounds[s.soundIDs[e]]._hasTimer&&s.sounds[s.soundIDs[e]]._onTimer()},J=function(n){n=n!==t?n:{},typeof s.onerror=="function"&&s.onerror.apply(e,[{type:n.type!==t?n.type:null}]),n.fatal!==t&&n.fatal&&s.disable()},jt=function(){if(!Gt||!Bt())return!1;var e=s.audioFormats,t,n;for(n in e)if(e.hasOwnProperty(n))if(n==="mp3"||n==="mp4"){s._wD(a+": Using flash fallback for "+n+" format"),s.html5[n]=!1;if(e[n]&&e[n].related)for(t=e[n].related.length-1;t>=0;t--)s.html5[e[n].related[t]]=!1}},this._setSandboxType=function(e){var n=s.sandbox;n.type=e,n.description=n.types[n.types[e]!==t?e:"unknown"],n.type==="localWithFile"?(n.noRemote=!0,n.noLocal=!1,k("secNote",2)):n.type==="localWithNetwork"?(n.noRemote=!1,n.noLocal=!0):n.type==="localTrusted"&&(n.noRemote=!1,n.noLocal=!1)},this._externalInterfaceOK=function(e){if(s.swfLoaded)return!1;var t;E("swf",!0),E("flashtojs",!0),s.swfLoaded=!0,en=!1,Gt&&jt();if(!e||e.replace(/\+dev/i,"")!==s.versionNumber.replace(/\+dev/i,""))return t=a+': Fatal: JavaScript file build "'+s.versionNumber+'" does not match Flash SWF build "'+e+'" at '+s.url+". Ensure both are up-to-date.",setTimeout(function(){throw new Error(t)},0),!1;setTimeout(g,Xt?100:1)},$=function(e,n){function r(){var e=[],t,n=[],r=" + ";t="SoundManager "+s.version+(!s.html5Only&&s.useHTML5Audio?s.hasHTML5?" + HTML5 audio":", no HTML5 audio support":""),s.html5Only?s.html5PollingInterval&&e.push("html5PollingInterval ("+s.html5PollingInterval+"ms)"):(s.preferFlash&&e.push("preferFlash"),s.useHighPerformance&&e.push("useHighPerformance"),s.flashPollingInterval&&e.push("flashPollingInterval ("+s.flashPollingInterval+"ms)"),s.html5PollingInterval&&e.push("html5PollingInterval ("+s.html5PollingInterval+"ms)"),s.wmode&&e.push("wmode ("+s.wmode+")"),s.debugFlash&&e.push("debugFlash"),s.useFlashBlock&&e.push("flashBlock")),e.length&&(n=n.concat([e.join(r)])),s._wD(t+(n.length?r+n.join(", "):""),1),It()}function C(e,t){return'<param name="'+e+'" value="'+t+'" />'}if(S&&x)return!1;if(s.html5Only)return F(),r(),s.oMC=c(s.movieID),g(),S=!0,x=!0,!1;var i=n||s.url,o=s.altURL||i,u="JS/Flash audio component (SoundManager 2)",a=V(),f=ot(),l=null,p=d.getElementsByTagName("html")[0],v,m,y,b,w,E,T,N;l=p&&p.dir&&p.dir.match(/rtl/i),e=e===t?s.id:e,F(),s.url=tt(on?i:o),n=s.url,s.wmode=!s.wmode&&s.useHighPerformance?"transparent":s.wmode,s.wmode!==null&&(h.match(/msie 8/i)||!Xt&&!s.useHighPerformance)&&navigator.platform.match(/win32|win64/i)&&(Et.push(q.spcWmode),s.wmode=null),v={name:e,id:e,src:n,quality:"high",allowScriptAccess:s.allowScriptAccess,bgcolor:s.bgColor,pluginspage:un+"www.macromedia.com/go/getflashplayer",title:u,type:"application/x-shockwave-flash",wmode:s.wmode,hasPriority:"true"},s.debugFlash&&(v.FlashVars="debug=1"),s.wmode||delete v.wmode;if(Xt)m=d.createElement("div"),b=['<object id="'+e+'" data="'+n+'" type="'+v.type+'" title="'+v.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+un+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',C("movie",n),C("AllowScriptAccess",s.allowScriptAccess),C("quality",v.quality),s.wmode?C("wmode",s.wmode):"",C("bgcolor",s.bgColor),C("hasPriority","true"),s.debugFlash?C("FlashVars",v.FlashVars):"","</object>"].join("");else{m=d.createElement("embed");for(y in v)v.hasOwnProperty(y)&&m.setAttribute(y,v[y])}Q(),f=ot(),a=V();if(a){s.oMC=c(s.movieID)||d.createElement("div");if(!s.oMC.id){s.oMC.id=s.movieID,s.oMC.className=ut.swfDefault+" "+f,E=null,w=null,s.useFlashBlock||(s.useHighPerformance?E={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(E={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},l&&(E.left=Math.abs(parseInt(E.left,10))+"px"))),Vt&&(s.oMC.style.zIndex=1e4);if(!s.debugFlash)for(T in E)E.hasOwnProperty(T)&&(s.oMC.style[T]=E[T]);try{Xt||s.oMC.appendChild(m),a.appendChild(s.oMC),Xt&&(w=s.oMC.appendChild(d.createElement("div")),w.className=ut.swfBox,w.innerHTML=b),x=!0}catch(k){throw new Error(it("domError")+" \n"+k.toString())}}else N=s.oMC.className,s.oMC.className=(N?N+" ":ut.swfDefault)+(f?" "+f:""),s.oMC.appendChild(m),Xt&&(w=s.oMC.appendChild(d.createElement("div")),w.className=ut.swfBox,w.innerHTML=b),x=!0}return S=!0,r(),!0},R=function(){return s.html5Only?($(),!1):u?!1:s.url?(u=s.getMovie(s.id),u||(nt?(Xt?s.oMC.innerHTML=rt:s.oMC.appendChild(nt),nt=null,S=!0):$(s.id,s.url),u=s.getMovie(s.id)),typeof s.oninitmovie=="function"&&setTimeout(s.oninitmovie,1),qt(),!0):(k("noURL"),!1)},B=function(){setTimeout(j,1e3)},j=function(){var t,n=!1;if(!s.url)return!1;if(pt)return!1;pt=!0,Mt.remove(e,"load",B);if(en&&!Zt)return k("waitFocus"),!1;T||(t=s.getMoviePercent(),t>0&&t<100&&(n=!0)),setTimeout(function(){t=s.getMoviePercent();if(n)return pt=!1,s._wD(it("waitSWF")),e.setTimeout(B,1),!1;T||(s._wD(a+": No Flash response within expected time. Likely causes: "+(t===0?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(s.debugFlash?" "+it("checkSWF"):""),2),!on&&t&&(k("localFail",2),s.debugFlash||k("tryDebug",2)),t===0&&s._wD(it("swf404",s.url),1),E("flashtojs",!1,": Timed out"+on?" (Check flash security or flash blockers)":" (No plugin/missing SWF?)")),!T&&tn&&(t===null?s.useFlashBlock||s.flashLoadTimeout===0?(s.useFlashBlock&&st(),k("waitForever")):!s.useFlashBlock&&St?e.setTimeout(function(){ct(f+"useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false..."),s.setup({preferFlash:!1}).reboot(),s.didFlashBlock=!0,s.beginDelayedInit()},1):(k("waitForever"),P({type:"ontimeout",ignoreInit:!0})):s.flashLoadTimeout===0?k("waitForever"):et(!0))},s.flashLoadTimeout)},I=function(){function t(){Mt.remove(e,"focus",I)}return Zt||!en?(t(),!0):(tn=!0,Zt=!0,k("gotFocus"),pt=!1,B(),t(),!0)},qt=function(){Et.length&&(s._wD("SoundManager 2: "+Et.join(" "),1),Et=[])},It=function(){qt();var e,t=[];if(s.useHTML5Audio&&s.hasHTML5){for(e in s.audioFormats)s.audioFormats.hasOwnProperty(e)&&t.push(e+" = "+s.html5[e]+(!s.html5[e]&&xt&&s.flash[e]?" (using flash)":s.preferFlash&&s.flash[e]&&xt?" (preferring flash)":s.html5[e]?"":" ("+(s.audioFormats[e].required?"required, ":"")+"and no flash support)"));s._wD("SoundManager 2 HTML5 support: "+t.join(", "),1)}},A=function(t){if(T)return!1;if(s.html5Only)return k("sm2Loaded"),T=!0,H(),E("onload",!0),!0;var n=s.useFlashBlock&&s.flashLoadTimeout&&!s.getMoviePercent(),r=!0,i;return n||(T=!0,N&&(i={type:!Ht&&xt?"NO_FLASH":"INIT_TIMEOUT"})),s._wD("SoundManager 2 "+(N?"failed to load":"loaded")+" ("+(N?"Flash security/load error":"OK")+")",N?2:1),N||t?(s.useFlashBlock&&s.oMC&&(s.oMC.className=ot()+" "+(s.getMoviePercent()===null?ut.swfTimedout:ut.swfError)),P({type:"ontimeout",error:i,ignoreInit:!0}),E("onload",!1),J(i),r=!1):E("onload",!0),N||(s.waitForWindowLoad&&!C?(k("waitOnload"),Mt.add(e,"load",H)):(s.waitForWindowLoad&&C&&k("docLoaded"),H())),r},m=function(){var e,n=s.setupOptions;for(e in n)n.hasOwnProperty(e)&&(s[e]===t?s[e]=n[e]:s[e]!==n[e]&&(s.setupOptions[e]=s[e]))},g=function(){function t(){Mt.remove(e,"load",s.beginDelayedInit)}if(T)return k("didInit"),!1;if(s.html5Only)return T||(t(),s.enabled=!0,A()),!0;R();try{u._externalInterfaceTest(!1),K(!0,s.flashPollingInterval||(s.useHighPerformance?10:50)),s.debugMode||u._disableDebug(),s.enabled=!0,E("jstoflash",!0),s.html5Only||Mt.add(e,"unload",v)}catch(n){return s._wD("js/flash exception: "+n.toString()),E("jstoflash",!1),J({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),et(!0),A(),!1}return A(),t(),!0},z=function(){return X?!1:(X=!0,m(),Q(),function(){var e="sm2-usehtml5audio=",t="sm2-preferflash=",n=null,r=null,i=p.toLowerCase();i.indexOf(e)!==-1&&(n=i.charAt(i.indexOf(e)+e.length)==="1",Yt&&console.log((n?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter"),s.setup({useHTML5Audio:n})),i.indexOf(t)!==-1&&(r=i.charAt(i.indexOf(t)+t.length)==="1",Yt&&console.log((r?"Enabling ":"Disabling ")+"preferFlash via URL parameter"),s.setup({preferFlash:r}))}(),!Ht&&s.hasHTML5&&(s._wD("SoundManager: No Flash detected"+(s.useHTML5Audio?". Trying HTML5-only mode.":", enabling HTML5."),1),s.setup({useHTML5Audio:!0,preferFlash:!1})),Ot(),!Ht&&xt&&(Et.push(q.needFlash),s.setup({flashLoadTimeout:1})),d.removeEventListener&&d.removeEventListener("DOMContentLoaded",z,!1),R(),!0)},At=function(){return d.readyState==="complete"&&(z(),d.detachEvent("onreadystatechange",At)),!0},W=function(){C=!0,Mt.remove(e,"load",W)},U=function(){if(Qt){(!s.setupOptions.useHTML5Audio||s.setupOptions.preferFlash)&&Et.push(q.mobileUA),s.setupOptions.useHTML5Audio=!0,s.setupOptions.preferFlash=!1;if(zt||Wt&&!h.match(/android\s2\.3/i))Et.push(q.globalHTML5),zt&&(s.ignoreFlash=!0),Dt=!0}},U(),Bt(),Mt.add(e,"focus",I),Mt.add(e,"load",B),Mt.add(e,"load",W),d.addEventListener?d.addEventListener("DOMContentLoaded",z,!1):d.attachEvent?d.attachEvent("onreadystatechange",At):(E("onload",!1),J({type:"NO_DOM2_EVENTS",fatal:!0}))}var n=null;if(e.SM2_DEFER===undefined||!SM2_DEFER)n=new r;e.SoundManager=r,e.soundManager=n})(window);